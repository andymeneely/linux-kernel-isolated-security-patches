--- ./drivers/scsi/aacraid/linit.c.orig	2007-10-04 11:53:27.000000000 +0200
+++ ./drivers/scsi/aacraid/linit.c	2007-10-04 11:53:10.000000000 +0200
@@ -609,6 +609,8 @@ static int aac_cfg_open(struct inode *in
 static int aac_cfg_ioctl(struct inode *inode,  struct file *file,
 		unsigned int cmd, unsigned long arg)
 {
+        if (!capable(CAP_SYS_ADMIN))
+                return -EPERM;
 	return aac_do_ioctl(file->private_data, cmd, (void __user *)arg);
 }
 

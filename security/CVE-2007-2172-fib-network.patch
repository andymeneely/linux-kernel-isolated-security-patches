--- linux-2.6.9/net/ipv4/fib_frontend.c.orig	2004-10-18 17:55:29.000000000 -0400
+++ linux-2.6.9/net/ipv4/fib_frontend.c	2007-06-08 16:24:39.000000000 -0400
@@ -288,6 +288,9 @@
 {
 	int i;
 
+	if (r->rtm_type > RTN_MAX)
+		return -EINVAL;
+
 	for (i=1; i<=RTA_MAX; i++) {
 		struct rtattr *attr = rta[i-1];
 		if (attr) {
--- linux-2.6.9/net/ipv4/fib_semantics.c.orig	2007-06-08 16:06:21.000000000 -0400
+++ linux-2.6.9/net/ipv4/fib_semantics.c	2007-06-08 16:25:47.000000000 -0400
@@ -86,7 +86,7 @@
 {
 	int	error;
 	u8	scope;
-} fib_props[RTA_MAX + 1] = {
+} fib_props[RTN_MAX + 1] = {
         {
 		.error	= 0,
 		.scope	= RT_SCOPE_NOWHERE,
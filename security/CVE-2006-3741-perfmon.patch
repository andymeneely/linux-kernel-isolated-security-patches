--- linux-2.6.9-40.EL-rse.orig/arch/ia64/kernel/perfmon.c
+++ linux-2.6.9-40.EL-rse/arch/ia64/kernel/perfmon.c
@@ -4934,13 +4934,15 @@ abort_locked:
 	if (likely(ctx)) {
 		DPRINT(("context unlocked\n"));
 		UNPROTECT_CTX(ctx, flags);
-		fput(file);
 	}
 
 	/* copy argument back to user, if needed */
 	if (call_made && PFM_CMD_RW_ARG(cmd) && copy_to_user(arg, args_k, base_sz*count)) ret = -EFAULT;
 
 error_args:
+ 	if (file)
+ 		fput(file);
+
 	if (args_k) kfree(args_k);
 
 	DPRINT(("cmd=%s ret=%ld\n", PFM_CMD_NAME(cmd), ret));

--- linux-2.6.9/drivers/net/wireless/ieee80211/ieee80211_rx.c.orig	2007-11-28 10:23:17.000000000 +0100
+++ linux-2.6.9/drivers/net/wireless/ieee80211/ieee80211_rx.c	2007-11-28 10:30:07.000000000 +0100
@@ -389,6 +389,12 @@ int ieee80211_rx(struct ieee80211_device
 	frag = WLAN_GET_SEQ_FRAG(sc);
 	hdrlen = ieee80211_get_hdrlen(fc);
 
+	if (skb->len < hdrlen) {
+		printk(KERN_INFO "%s: invalid SKB length %d\n",
+			dev->name, skb->len);
+		goto rx_dropped;
+	}
+
 #ifdef NOT_YET
 #if WIRELESS_EXT > 15
 	/* Put this code here so that we avoid duplicating it in all
--- linux-2.6.9/security/selinux/hooks.c	2006-03-13 12:45:15.000000000 -0500
+++ linux-2.6.9.w/security/selinux/hooks.c	2006-03-13 12:48:01.000000000 -0500
@@ -1361,7 +1361,7 @@ static int selinux_ptrace(struct task_st
 
 	rc = task_has_perm(parent, child, PROCESS__PTRACE);
 	/* Save the SID of the tracing process for later use in apply_creds. */
-	if (!rc)
+	if (!(child->ptrace & PT_PTRACED) && !rc)
 		csec->ptrace_sid = psec->sid;
 	return rc;
 }

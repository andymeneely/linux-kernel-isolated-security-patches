--- linux-2.6.9/fs/exec.c.orig	2007-12-07 12:09:26.000000000 -0800
+++ linux-2.6.9/fs/exec.c	2007-12-07 12:09:28.000000000 -0800
@@ -1540,6 +1540,12 @@
 
 	if (!S_ISREG(inode->i_mode))
 		goto close_fail;
+	/*
+	 * Dont allow local users get cute and trick others to coredump
+	 * into their pre-created files:
+	 */
+	if (inode->i_uid != current->fsuid)
+		goto close_fail;
 	if (!file->f_op)
 		goto close_fail;
 	if (!file->f_op->write)

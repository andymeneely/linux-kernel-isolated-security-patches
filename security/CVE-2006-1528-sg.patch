--- linux-2.6.9/drivers/scsi/sg.c.bak	2006-05-17 11:17:21.000000000 -0400
+++ linux-2.6.9/drivers/scsi/sg.c	2006-05-17 11:18:10.000000000 -0400
@@ -1734,7 +1734,7 @@ st_map_user_pages(struct scatterlist *sg
 	up_read(&current->mm->mmap_sem);
 
 	/* Errors and no page mapped should return here */
-	if (res < nr_pages)
+	if ((res < 0) || (res < nr_pages))
 		goto out_unmap;
 
         for (i=0; i < nr_pages; i++) {

--- linux-2.6.9.orig/net/ipv4/igmp.c	2005-12-18 10:27:43.000000000 +0100
+++ linux-2.6.9/net/ipv4/igmp.c	2005-12-18 10:35:27.000000000 +0100
@@ -890,7 +890,10 @@
 		/* Is it our report looped back? */
 		if (((struct rtable*)skb->dst)->fl.iif == 0)
 			break;
-		igmp_heard_report(in_dev, ih->group);
+		/* don't rely on MC router hearing unicast reports */
+		if (skb->pkt_type == PACKET_MULTICAST ||
+		    skb->pkt_type == PACKET_BROADCAST)
+			igmp_heard_report(in_dev, ih->group);
 		break;
 	case IGMP_PIM:
 #ifdef CONFIG_IP_PIMSM_V1
--- linux-2.6.9.orig/net/ipv6/mcast.c	2005-12-18 10:27:43.000000000 +0100
+++ linux-2.6.9/net/ipv6/mcast.c	2005-12-18 10:35:27.000000000 +0100
@@ -1177,6 +1177,11 @@
 	if (skb->pkt_type == PACKET_LOOPBACK)
 		return 0;
 
+	/* send our report if the MC router may not have heard this report */
+	if (skb->pkt_type != PACKET_MULTICAST &&
+	    skb->pkt_type != PACKET_BROADCAST)
+		return 0;
+
 	if (!pskb_may_pull(skb, sizeof(struct in6_addr)))
 		return -EINVAL;
 

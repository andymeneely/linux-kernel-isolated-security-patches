--- linux-2.6.9/mm/mempolicy.c.orig
+++ linux-2.6.9/mm/mempolicy.c
@@ -138,6 +138,9 @@ static int get_nodes(unsigned long *node
 		return 0;
 
 	nlongs = BITS_TO_LONGS(maxnode);
+	if (nlongs == 0)
+		return -EINVAL;
+
 	if ((maxnode % BITS_PER_LONG) == 0)
 		endmask = ~0UL;
 	else

--- linux-2.6.9.orig/drivers/isdn/capi/capiutil.c	2007-06-28 09:03:10.000000000 +0200
+++ linux-2.6.9/drivers/isdn/capi/capiutil.c	2007-06-28 09:03:28.000000000 +0200
@@ -713,8 +713,12 @@ static char *p = NULL;
 static void bufprint(char *fmt,...)
 {
 	va_list f;
+	size_t remain = (p >= buf && p < buf+sizeof(buf)) 
+		        ? buf+sizeof(buf)-p 
+		        : 0;
+
 	va_start(f, fmt);
-	vsprintf(p, fmt, f);
+	vsnprintf(p, remain, fmt, f);
 	va_end(f);
 	p += strlen(p);
 }
 
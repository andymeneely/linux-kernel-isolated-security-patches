--- linux-2.6.9/net/sctp/sm_statefuns.c.orig	2006-05-25 13:45:05.000000000 -0400
+++ linux-2.6.9/net/sctp/sm_statefuns.c	2006-05-25 13:45:48.000000000 -0400
@@ -896,6 +896,12 @@
 		return sctp_sf_pdiscard(ep, asoc, type, arg, commands);
 
 	hbinfo = (sctp_sender_hb_info_t *) chunk->skb->data;
+	/* Make sure that the length of the parameter is what we expect */
+	if (ntohs(hbinfo->param_hdr.length) !=
+				    sizeof(sctp_sender_hb_info_t)) {
+		return SCTP_DISPOSITION_DISCARD;
+	}
+
 	from_addr = hbinfo->daddr;
 	link = sctp_assoc_lookup_paddr(asoc, &from_addr);
 
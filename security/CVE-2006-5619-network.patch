--- linux-2.6.9.orig/net/ipv6/ip6_flowlabel.c	2006-09-25 10:27:49.000000000 +0200
+++ linux-2.6.9/net/ipv6/ip6_flowlabel.c	2006-12-08 16:14:26.000000000 +0100
@@ -588,6 +588,8 @@
 	while (!fl) {
 		if (++state->bucket <= FL_HASH_MASK)
 			fl = fl_ht[state->bucket];
+		else
+			break;
 	}
 	return fl;
 }
--- linux-2.6.9/fs/proc/task_mmu.c.orig	2006-04-12 12:54:00.000000000 -0400
+++ linux-2.6.9/fs/proc/task_mmu.c	2006-04-12 12:55:23.000000000 -0400
@@ -55,9 +55,6 @@
 
 static int show_map(struct seq_file *m, void *v)
 {
-#ifdef __i386__
-	struct task_struct *task = m->private;
-#endif
 	struct vm_area_struct *map = v;
 	struct file *file = map->vm_file;
 	int flags = map->vm_flags;
@@ -78,8 +75,8 @@
 			flags & VM_WRITE ? 'w' : '-',
 			(flags & VM_EXEC
 #ifdef __i386__
-				|| (!nx_enabled &&
-				(map->vm_start < task->mm->context.exec_limit))
+				|| (!nx_enabled && map->vm_mm &&
+				(map->vm_start < map->vm_mm->context.exec_limit))
 #endif
 			)
 				? 'x' : '-',